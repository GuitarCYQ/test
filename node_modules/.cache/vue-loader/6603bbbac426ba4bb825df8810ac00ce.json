{"remainingRequest":"D:\\software\\file\\test\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\software\\file\\test\\src\\components\\VabUpload\\index.vue?vue&type=style&index=0&id=7340870a&lang=scss&scoped=true&","dependencies":[{"path":"D:\\software\\file\\test\\src\\components\\VabUpload\\index.vue","mtime":1638330357249},{"path":"D:\\software\\file\\test\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\software\\file\\test\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\software\\file\\test\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\software\\file\\test\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\software\\file\\test\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\software\\file\\test\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLnVwbG9hZCB7CiAgaGVpZ2h0OiA1MDBweDsKCiAgLnVwbG9hZC1jb250ZW50IHsKICAgIC5lbC11cGxvYWRfX3RpcCB7CiAgICAgIGRpc3BsYXk6IGJsb2NrOwogICAgICBoZWlnaHQ6IDMwcHg7CiAgICAgIGxpbmUtaGVpZ2h0OiAzMHB4OwogICAgfQoKICAgIDo6di1kZWVwIHsKICAgICAgLmVsLXVwbG9hZC0tcGljdHVyZS1jYXJkIHsKICAgICAgICB3aWR0aDogMTI4cHg7CiAgICAgICAgaGVpZ2h0OiAxMjhweDsKICAgICAgICBtYXJnaW46IDNweCA4cHggOHB4IDhweDsKICAgICAgICBib3JkZXI6IDJweCBkYXNoZWQgI2MwY2NkYTsKICAgICAgfQoKICAgICAgLmVsLXVwbG9hZC1saXN0LS1waWN0dXJlIHsKICAgICAgICBtYXJnaW4tYm90dG9tOiAyMHB4OwogICAgICB9CgogICAgICAuZWwtdXBsb2FkLWxpc3QtLXBpY3R1cmUtY2FyZCB7CiAgICAgICAgLmVsLXVwbG9hZC1saXN0X19pdGVtIHsKICAgICAgICAgIHdpZHRoOiAxMjhweDsKICAgICAgICAgIGhlaWdodDogMTI4cHg7CiAgICAgICAgICBtYXJnaW46IDNweCA4cHggOHB4IDhweDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8NA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/VabUpload","sourcesContent":["<template>\n  <el-dialog\n    :before-close=\"handleClose\"\n    :close-on-click-modal=\"false\"\n    :title=\"title\"\n    :visible.sync=\"dialogFormVisible\"\n    width=\"909px\"\n  >\n    <div class=\"upload\">\n      <el-alert\n        :closable=\"false\"\n        :title=\"`支持jpg、jpeg、png格式，单次可最多选择${limit}张图片，每张不可大于${size}M，如果大于${size}M会自动为您过滤`\"\n        type=\"info\"\n      ></el-alert>\n      <br />\n      <el-upload\n        ref=\"upload\"\n        :action=\"action\"\n        :auto-upload=\"false\"\n        :close-on-click-modal=\"false\"\n        :data=\"data\"\n        :file-list=\"fileList\"\n        :headers=\"headers\"\n        :limit=\"limit\"\n        :multiple=\"true\"\n        :name=\"name\"\n        :on-change=\"handleChange\"\n        :on-error=\"handleError\"\n        :on-exceed=\"handleExceed\"\n        :on-preview=\"handlePreview\"\n        :on-progress=\"handleProgress\"\n        :on-remove=\"handleRemove\"\n        :on-success=\"handleSuccess\"\n        accept=\"image/png, image/jpeg\"\n        class=\"upload-content\"\n        list-type=\"picture-card\"\n      >\n        <i slot=\"trigger\" class=\"el-icon-plus\"></i>\n        <el-dialog\n          :visible.sync=\"dialogVisible\"\n          append-to-body\n          title=\"查看大图\"\n        >\n          <div>\n            <img :src=\"dialogImageUrl\" alt=\"\" width=\"100%\" />\n          </div>\n        </el-dialog>\n      </el-upload>\n    </div>\n    <div\n      slot=\"footer\"\n      class=\"dialog-footer\"\n      style=\"position: relative; padding-right: 15px; text-align: right\"\n    >\n      <div\n        v-if=\"show\"\n        style=\"position: absolute; top: 10px; left: 15px; color: #999\"\n      >\n        正在上传中... 当前上传成功数:{{ imgSuccessNum }}张 当前上传失败数:{{\n          imgErrorNum\n        }}张\n      </div>\n      <el-button type=\"primary\" @click=\"handleClose\">关闭</el-button>\n      <el-button\n        :loading=\"loading\"\n        size=\"small\"\n        style=\"margin-left: 10px\"\n        type=\"success\"\n        @click=\"submitUpload\"\n      >\n        开始上传\n      </el-button>\n    </div>\n  </el-dialog>\n</template>\n\n<script>\n  import { baseURL, tokenName } from '@/config'\n\n  export default {\n    name: 'VabUpload',\n    props: {\n      url: {\n        type: String,\n        default: '/upload',\n        required: true,\n      },\n      name: {\n        type: String,\n        default: 'file',\n        required: true,\n      },\n      limit: {\n        type: Number,\n        default: 50,\n        required: true,\n      },\n      size: {\n        type: Number,\n        default: 1,\n        required: true,\n      },\n    },\n    data() {\n      return {\n        show: false,\n        loading: false,\n        dialogVisible: false,\n        dialogImageUrl: '',\n        action: 'https://vab-unicloud-3a9da9.service.tcloudbase.com/upload',\n        headers: {},\n        fileList: [],\n        picture: 'picture',\n        imgNum: 0,\n        imgSuccessNum: 0,\n        imgErrorNum: 0,\n        typeList: null,\n        title: '上传',\n        dialogFormVisible: false,\n        data: {},\n      }\n    },\n    computed: {\n      percentage() {\n        if (this.allImgNum == 0) return 0\n        return this.$baseLodash.round(this.imgNum / this.allImgNum, 2) * 100\n      },\n    },\n    methods: {\n      submitUpload() {\n        this.$refs.upload.submit()\n      },\n      handleProgress(event, file, fileList) {\n        this.loading = true\n        this.show = true\n      },\n      handleChange(file, fileList) {\n        if (file.size > 1048576 * this.size) {\n          fileList.map((item, index) => {\n            if (item === file) {\n              fileList.splice(index, 1)\n            }\n          })\n          this.fileList = fileList\n        } else {\n          this.allImgNum = fileList.length\n        }\n      },\n      handleSuccess(response, file, fileList) {\n        this.imgNum = this.imgNum + 1\n        this.imgSuccessNum = this.imgSuccessNum + 1\n        if (fileList.length === this.imgNum) {\n          setTimeout(() => {\n            this.$baseMessage(\n              `上传完成! 共上传${fileList.length}张图片`,\n              'success'\n            )\n          }, 1000)\n        }\n\n        setTimeout(() => {\n          this.loading = false\n          this.show = false\n        }, 1000)\n      },\n      handleError(err, file, fileList) {\n        this.imgNum = this.imgNum + 1\n        this.imgErrorNum = this.imgErrorNum + 1\n        this.$baseMessage(\n          `文件[${file.raw.name}]上传失败,文件大小为${this.$baseLodash.round(\n            file.raw.size / 1024,\n            0\n          )}KB`,\n          'error'\n        )\n        setTimeout(() => {\n          this.loading = false\n          this.show = false\n        }, 1000)\n      },\n      handleRemove(file, fileList) {\n        this.imgNum = this.imgNum - 1\n        this.allNum = this.allNum - 1\n      },\n      handlePreview(file) {\n        this.dialogImageUrl = file.url\n        this.dialogVisible = true\n      },\n      handleExceed(files, fileList) {\n        this.$baseMessage(\n          `当前限制选择 ${this.limit} 个文件，本次选择了\n             ${files.length}\n             个文件`,\n          'error'\n        )\n      },\n      handleShow(data) {\n        this.title = '上传'\n        this.data = data\n        this.dialogFormVisible = true\n      },\n      handleClose() {\n        this.fileList = []\n        this.picture = 'picture'\n        this.allImgNum = 0\n        this.imgNum = 0\n        this.imgSuccessNum = 0\n        this.imgErrorNum = 0\n        /* if (\"development\" === process.env.NODE_ENV) {\n          this.api = process.env.VUE_APP_BASE_API;\n        } else {\n          this.api = `${window.location.protocol}//${window.location.host}`;\n        }\n\n        this.action = this.api + this.url; */\n        this.dialogFormVisible = false\n      },\n    },\n  }\n</script>\n\n<style lang=\"scss\" scoped>\n  .upload {\n    height: 500px;\n\n    .upload-content {\n      .el-upload__tip {\n        display: block;\n        height: 30px;\n        line-height: 30px;\n      }\n\n      ::v-deep {\n        .el-upload--picture-card {\n          width: 128px;\n          height: 128px;\n          margin: 3px 8px 8px 8px;\n          border: 2px dashed #c0ccda;\n        }\n\n        .el-upload-list--picture {\n          margin-bottom: 20px;\n        }\n\n        .el-upload-list--picture-card {\n          .el-upload-list__item {\n            width: 128px;\n            height: 128px;\n            margin: 3px 8px 8px 8px;\n          }\n        }\n      }\n    }\n  }\n</style>\n"]}]}