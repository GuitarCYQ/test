{"remainingRequest":"D:\\software\\file\\test\\node_modules\\babel-loader\\lib\\index.js!D:\\software\\file\\test\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\software\\file\\test\\src\\config\\permission.js","dependencies":[{"path":"D:\\software\\file\\test\\src\\config\\permission.js","mtime":1638330357262},{"path":"D:\\software\\file\\test\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\software\\file\\test\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\software\\file\\test\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YuanMiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICJEOi9zb2Z0d2FyZS9maWxlL3Rlc3Qvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJEOi9zb2Z0d2FyZS9maWxlL3Rlc3Qvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwoKLyoqCiAqIEBhdXRob3IgY2h1emhpeGluIDEyMDQ1MDUwNTZAcXEuY29tIO+8iOS4jeaDs+S/neeVmWF1dGhvcuWPr+WIoOmZpO+8iQogKiBAZGVzY3JpcHRpb24g6Lev55Sx5a6I5Y2r77yM55uu5YmN5Lik56eN5qih5byP77yaYWxs5qih5byP5LiOaW50ZWxsaWdlbmNl5qih5byPCiAqLwppbXBvcnQgcm91dGVyIGZyb20gJ0Avcm91dGVyJzsKaW1wb3J0IHN0b3JlIGZyb20gJ0Avc3RvcmUnOwppbXBvcnQgVmFiUHJvZ3Jlc3MgZnJvbSAnbnByb2dyZXNzJzsKaW1wb3J0ICducHJvZ3Jlc3MvbnByb2dyZXNzLmNzcyc7CmltcG9ydCBnZXRQYWdlVGl0bGUgZnJvbSAnQC91dGlscy9wYWdlVGl0bGUnOwppbXBvcnQgeyBhdXRoZW50aWNhdGlvbiwgbG9naW5JbnRlcmNlcHRpb24sIHByb2dyZXNzQmFyLCByZWNvcmRSb3V0ZSwgcm91dGVzV2hpdGVMaXN0IH0gZnJvbSAnQC9jb25maWcnOwpWYWJQcm9ncmVzcy5jb25maWd1cmUoewogIGVhc2luZzogJ2Vhc2UnLAogIHNwZWVkOiA1MDAsCiAgdHJpY2tsZVNwZWVkOiAyMDAsCiAgc2hvd1NwaW5uZXI6IGZhbHNlCn0pOwpyb3V0ZXIuYmVmb3JlUmVzb2x2ZSggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh0bywgZnJvbSwgbmV4dCkgewogICAgdmFyIGhhc1Rva2VuLCBoYXNQZXJtaXNzaW9ucywgcGVybWlzc2lvbnMsIGFjY2Vzc1JvdXRlczsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgaWYgKHByb2dyZXNzQmFyKSBWYWJQcm9ncmVzcy5zdGFydCgpOwogICAgICAgICAgICBoYXNUb2tlbiA9IHN0b3JlLmdldHRlcnNbJ3VzZXIvYWNjZXNzVG9rZW4nXTsKICAgICAgICAgICAgaWYgKCFsb2dpbkludGVyY2VwdGlvbikgaGFzVG9rZW4gPSB0cnVlOwoKICAgICAgICAgICAgaWYgKCFoYXNUb2tlbikgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0NjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCEodG8ucGF0aCA9PT0gJy9sb2dpbicpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5leHQoewogICAgICAgICAgICAgIHBhdGg6ICcvJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKHByb2dyZXNzQmFyKSBWYWJQcm9ncmVzcy5kb25lKCk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0NDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICBoYXNQZXJtaXNzaW9ucyA9IHN0b3JlLmdldHRlcnNbJ3VzZXIvcGVybWlzc2lvbnMnXSAmJiBzdG9yZS5nZXR0ZXJzWyd1c2VyL3Blcm1pc3Npb25zJ10ubGVuZ3RoID4gMDsKCiAgICAgICAgICAgIGlmICghaGFzUGVybWlzc2lvbnMpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5leHQoKTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ0OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTQ7CgogICAgICAgICAgICBpZiAobG9naW5JbnRlcmNlcHRpb24pIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxODsKICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCd1c2VyL3NldFBlcm1pc3Npb25zJywgWydhZG1pbiddKTsKCiAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICBwZXJtaXNzaW9ucyA9IFsnYWRtaW4nXTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI0OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjM7CiAgICAgICAgICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaCgndXNlci9nZXRVc2VySW5mbycpOwoKICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgIHBlcm1pc3Npb25zID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICBhY2Nlc3NSb3V0ZXMgPSBbXTsKCiAgICAgICAgICAgIGlmICghKGF1dGhlbnRpY2F0aW9uID09PSAnaW50ZWxsaWdlbmNlJykpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzE7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyODsKICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCdyb3V0ZXMvc2V0Um91dGVzJywgcGVybWlzc2lvbnMpOwoKICAgICAgICAgIGNhc2UgMjg6CiAgICAgICAgICAgIGFjY2Vzc1JvdXRlcyA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzNTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAzMToKICAgICAgICAgICAgaWYgKCEoYXV0aGVudGljYXRpb24gPT09ICdhbGwnKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzNTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM0OwogICAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ3JvdXRlcy9zZXRBbGxSb3V0ZXMnKTsKCiAgICAgICAgICBjYXNlIDM0OgogICAgICAgICAgICBhY2Nlc3NSb3V0ZXMgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgIGNhc2UgMzU6CiAgICAgICAgICAgIHJvdXRlci5hZGRSb3V0ZXMoYWNjZXNzUm91dGVzKTsKICAgICAgICAgICAgbmV4dChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRvKSwge30sIHsKICAgICAgICAgICAgICByZXBsYWNlOiB0cnVlCiAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ0OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDM5OgogICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMzk7CiAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMTQpOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDM7CiAgICAgICAgICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaCgndXNlci9yZXNldEFjY2Vzc1Rva2VuJyk7CgogICAgICAgICAgY2FzZSA0MzoKICAgICAgICAgICAgaWYgKHByb2dyZXNzQmFyKSBWYWJQcm9ncmVzcy5kb25lKCk7CgogICAgICAgICAgY2FzZSA0NDoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ3OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDQ2OgogICAgICAgICAgICBpZiAocm91dGVzV2hpdGVMaXN0LmluZGV4T2YodG8ucGF0aCkgIT09IC0xKSB7CiAgICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGlmIChyZWNvcmRSb3V0ZSkgewogICAgICAgICAgICAgICAgbmV4dCgiL2xvZ2luP3JlZGlyZWN0PSIuY29uY2F0KHRvLnBhdGgpKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmV4dCgnL2xvZ2luJyk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAocHJvZ3Jlc3NCYXIpIFZhYlByb2dyZXNzLmRvbmUoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgIGNhc2UgNDc6CiAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gZ2V0UGFnZVRpdGxlKHRvLm1ldGEudGl0bGUpOwoKICAgICAgICAgIGNhc2UgNDg6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSwgbnVsbCwgW1sxNCwgMzldXSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gKF94LCBfeDIsIF94MykgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCkpOwpyb3V0ZXIuYWZ0ZXJFYWNoKGZ1bmN0aW9uICgpIHsKICBpZiAocHJvZ3Jlc3NCYXIpIFZhYlByb2dyZXNzLmRvbmUoKTsKfSk7"},{"version":3,"sources":["D:/software/file/test/src/config/permission.js"],"names":["router","store","VabProgress","getPageTitle","authentication","loginInterception","progressBar","recordRoute","routesWhiteList","configure","easing","speed","trickleSpeed","showSpinner","beforeResolve","to","from","next","start","hasToken","getters","path","done","hasPermissions","length","dispatch","permissions","accessRoutes","addRoutes","replace","indexOf","document","title","meta","afterEach"],"mappings":"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","sourcesContent":["/**\n * @author chuzhixin 1204505056@qq.com （不想保留author可删除）\n * @description 路由守卫，目前两种模式：all模式与intelligence模式\n */\nimport router from '@/router'\nimport store from '@/store'\nimport VabProgress from 'nprogress'\nimport 'nprogress/nprogress.css'\nimport getPageTitle from '@/utils/pageTitle'\nimport {\n  authentication,\n  loginInterception,\n  progressBar,\n  recordRoute,\n  routesWhiteList,\n} from '@/config'\n\nVabProgress.configure({\n  easing: 'ease',\n  speed: 500,\n  trickleSpeed: 200,\n  showSpinner: false,\n})\nrouter.beforeResolve(async (to, from, next) => {\n  if (progressBar) VabProgress.start()\n  let hasToken = store.getters['user/accessToken']\n\n  if (!loginInterception) hasToken = true\n\n  if (hasToken) {\n    if (to.path === '/login') {\n      next({ path: '/' })\n      if (progressBar) VabProgress.done()\n    } else {\n      const hasPermissions =\n        store.getters['user/permissions'] &&\n        store.getters['user/permissions'].length > 0\n      if (hasPermissions) {\n        next()\n      } else {\n        try {\n          let permissions\n          if (!loginInterception) {\n            //settings.js loginInterception为false时，创建虚拟权限\n            await store.dispatch('user/setPermissions', ['admin'])\n            permissions = ['admin']\n          } else {\n            permissions = await store.dispatch('user/getUserInfo')\n          }\n\n          let accessRoutes = []\n          if (authentication === 'intelligence') {\n            accessRoutes = await store.dispatch('routes/setRoutes', permissions)\n          } else if (authentication === 'all') {\n            accessRoutes = await store.dispatch('routes/setAllRoutes')\n          }\n          router.addRoutes(accessRoutes)\n          next({ ...to, replace: true })\n        } catch {\n          await store.dispatch('user/resetAccessToken')\n          if (progressBar) VabProgress.done()\n        }\n      }\n    }\n  } else {\n    if (routesWhiteList.indexOf(to.path) !== -1) {\n      next()\n    } else {\n      if (recordRoute) {\n        next(`/login?redirect=${to.path}`)\n      } else {\n        next('/login')\n      }\n\n      if (progressBar) VabProgress.done()\n    }\n  }\n  document.title = getPageTitle(to.meta.title)\n})\nrouter.afterEach(() => {\n  if (progressBar) VabProgress.done()\n})\n"]}]}